<!DOCTYPE html>
<html lang="en"
      th:replace="~{base :: parent(~{::#content},~{::title},~{::script})}">
<head>
    <title th:text="${loggedInUser.name + ' | Dashboard'}">Dashboard</title>
</head>
<body>
<div id="content" class="min-h-screen bg-gray-50">

    <!-- Sidebar -->
    <div th:replace="~{User/sidebar :: sidebar}"></div>

    <!-- Main Dashboard -->
    <div class="ml-64 p-6 space-y-8">

        <!-- Welcome Header -->
        <div class="bg-blue-600 text-white rounded-xl shadow-lg p-8 animate__animated animate__fadeInDown">
            <h2 class="text-3xl font-bold">Hi <span th:text="${loggedInUser.name}">User</span>, welcome back!</h2>
            <p class="mt-2">Here’s a quick look at your contacts.</p>
        </div>

        <!-- Actions -->
        <div class="flex justify-between items-center">
            <input id="searchInput" onkeyup="filterContacts()" type="text"
                   placeholder="Search contacts..."
                   class="w-1/2 px-4 py-2 border rounded shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"/>

            <button onclick="openModal()"
                    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium shadow transition">
                + Add Contact
            </button>
        </div>

        <!-- Contacts Grid -->
        <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="contactList">
            <div th:each="contact : ${contacts}"
                 class="bg-white p-6 rounded-xl shadow hover:shadow-lg transition-all duration-300">
                <h3 class="text-xl font-semibold text-gray-800 mb-1" th:text="${contact.name}">John Doe</h3>
                <p class="text-gray-600" th:text="${contact.email}">john@example.com</p>
                <p class="text-gray-600" th:text="${contact.phone}">+91 9876543210</p>
                <div class="mt-4 flex gap-4 text-sm">
                    <a th:href="@{/contacts/view/{id}(id=${contact.id})}" class="text-blue-600 hover:underline">View</a>
                    <a th:href="@{/contacts/edit/{id}(id=${contact.id})}" class="text-yellow-500 hover:underline">Edit</a>
                    <a th:href="@{/contacts/delete/{id}(id=${contact.id})}"
                       onclick="return confirm('Delete this contact?')"
                       class="text-red-500 hover:underline">Delete</a>
                </div>
            </div>
        </div>

        <!-- Add Contact Modal -->
        <div id="addModal"
             class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
            <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-lg animate__animated animate__zoomIn">
                <h2 class="text-2xl font-bold mb-4">Add New Contact</h2>
                <form th:action="@{/contacts/add}" method="post" class="space-y-4">
                    <input name="name" type="text" placeholder="Full Name"
                           class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                    <input name="email" type="email" placeholder="Email"
                           class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                    <input name="phone" type="text" placeholder="Phone"
                           class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500"/>
                    <div class="flex justify-end gap-3 pt-4">
                        <button type="button" onclick="closeModal()"
                                class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">Cancel</button>
                        <button type="submit"
                                class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-500 text-sm mt-8 py-4">
            © 2025 Smart Contacts Manager | <a class="text-blue-500 hover:underline" href="https://www.linkedin.com/in/gulrez-sarankar">LinkedIn</a> | <a class="text-blue-500 hover:underline" href="https://www.instagram.com/gulrez_sarankar18/">Instagram</a>
        </footer>

    </div>
</div>

<!-- JS -->
<script>
    function openModal() {
        document.getElementById("addModal").classList.remove("hidden");
    }

    function closeModal() {
        document.getElementById("addModal").classList.add("hidden");
    }

    function filterContacts() {
        const input = document.getElementById("searchInput").value.toLowerCase();
        const cards = document.getElementById("contactList").children;
        for (let card of cards) {
            const name = card.querySelector("h3").textContent.toLowerCase();
            card.style.display = name.includes(input) ? "block" : "none";
        }
    }
</script>
</body>
</html>
